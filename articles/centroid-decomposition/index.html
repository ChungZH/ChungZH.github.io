<!doctype html><html lang=zh-cn><head><meta charset=utf-8><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><title>点分治笔记 | ChungZH's Blog</title><meta property="og:site_name" content="ChungZH's Blog"><meta property="og:title" content="点分治笔记 | ChungZH's Blog"><meta itemprop=name content="点分治笔记 | ChungZH's Blog"><meta name=twitter:title content="点分治笔记 | ChungZH's Blog"><meta name=application-name content="点分治笔记 | ChungZH's Blog"><link rel="shortcut icon" href=/BlogFavicon16.png><meta name=twitter:card content="summary"><meta name=description content="Welcome to my blog!"><meta name=twitter:description content="Welcome to my blog!"><meta itemprop=description content="Welcome to my blog!"><meta property="og:description" content="Welcome to my blog!"><link rel=stylesheet href="https://blog.chungzh.cn/sass/main.min.7282f6bbf341e3d53b04c9caa46bee016e558c91f2f9e48deaa3383817abd770.css" integrity="sha256-coL2u/NB49U7BMnKpGvuAW5VjJHy+eSN6qM4OBer13A="></head><body class="bg-white dark:bg-slate-900 text-slate-500 dark:text-slate-400"><header class="sticky top-0 z-40"><div class="w-full backdrop-blur bg-white/80 dark:bg-slate-900/75 lg:border-b lg:border-slate-900/10 dark:border-slate-50/[0.06]"><div class="py-4 border-b border-slate-900/10 lg:px-8 lg:border-0 dark:border-slate-300/10 mx-4 lg:mx-0"><div class="px-20 relative flex flex-wrap justify-between"><div class="relative flex items-center"><a href=/><div class="flex gap-3 items-center text-xl font-bold text-slate-800 dark:text-slate-200"><img class="w-auto h-8" src=/BlogFavicon16.png title=logo>
<span class="hover:text-sky-500 dark:hover:text-sky-400">ChungZH's Blog</span></div></a></div><div class="relative flex items-center"><div class="flex gap-5 items-center leading-6 font-semibold text-slate-700 dark:text-slate-200"><a class="hover:text-sky-500 dark:hover:text-sky-400" href=/about/>关于</a>
<a class="hover:text-sky-500 dark:hover:text-sky-400" href=/categories/>分类</a>
<a class="hover:text-sky-500 dark:hover:text-sky-400" href=/friends/>友链</a>
<a class="hover:text-sky-500 dark:hover:text-sky-400" href=/archives/>存档</a>
<a class="hover:text-sky-500 dark:hover:text-sky-400" href=/tags/>标签</a></div></div></div></div></div></header><div class="max-w-3xl mx-auto pb-28"><main class="max-w-[52rem] mx-auto py-10"><div class=container><article><header class=article-header><div class=thumb><div><div class=post-tags><a class=tag href=/tags/oi/>#OI</a>
<a class=tag href=/tags/%E7%AE%97%E6%B3%95/>#算法</a>
<a class=tag href=/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/>#数据结构</a>
<a class=tag href=/tags/%E6%A0%91%E7%9A%84%E9%87%8D%E5%BF%83/>#树的重心</a>
<a class=tag href=/tags/%E7%82%B9%E5%88%86%E6%B2%BB/>#点分治</a></div><h1 class=post-title>点分治笔记</h1><div class=post-meta>By ChungZH<div class="font-bold text-sky-500 dark:text-sky-400">·</div><time>August 02, 2022</time><div class="font-bold text-sky-500 dark:text-sky-400">·</div>5 minutes</div></div></div></header></article><aside class=toc><nav id=TableOfContents><ul><li><a href=#何为树的重心>何为树的重心</a></li><li><a href=#寻找树的重心>寻找树的重心</a></li><li><a href=#点分治>点分治</a><ul><li><a href=#例一>例一</a></li><li><a href=#例二>例二</a></li><li><a href=#例三>例三</a></li></ul></li><li><a href=#习题>习题</a></li><li><a href=#参考资料>参考资料</a></li></ul></nav></aside><div class=article-post><p>点分治，外国人称之为 Centroid decomposition，重心分解。</p><h2 id=何为树的重心><a href=#%e4%bd%95%e4%b8%ba%e6%a0%91%e7%9a%84%e9%87%8d%e5%bf%83 class=anchor><svg class="icon" aria-hidden="true" focusable="false" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5.0-3-1.69-3-3.5S2.55 3 4 3h4c1.45.0 3 1.69 3 3.5.0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98.0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98.0-2-1.22-2-2.5.0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45.0 3-1.69 3-3.5S14.5 6 13 6z"/></svg></a>何为树的重心</h2><p>学习重心分解之前，自然要先了解重心。</p><p>下面统一用 $n$ 表示树上结点的个数。</p><p>在一棵树中，如果删除一个顶点后得到的最大子树的顶点数最少，那么这个点就是<strong>树的重心</strong>（Centroid）。</p><p>重心的性质：</p><ol><li><p>删除重心后得到的所有子树，其顶点数必然不超过 $n/2$。</p><p>证明：选取任意顶点作为起点，每次都沿着边向最大子树的方向移动，最终一定会到达某个顶点，将其删除后得到的所有子树的顶点数都不超过 $n/2$。如果这样的点存在的话，那么也就可以证明删除重心后得到的所有子树的顶点数都不超过 $n/2$。</p><p>记当前顶点为 $v$，如果顶点 $v$ 已经满足上述条件则停止。否则，与顶点 $v$ 邻接的某个子树的顶点数必然大于 $n/2$。假设顶点 $v$ 与该子树中的顶点 $w$ 邻接，那么我们就把顶点 $w$ 作为新的顶点 $v$。不断重复这一步骤，必然会在有限步停止。这是因为对于移动中所用的边 $(v, w)$，必有 $v$ 侧的子树的顶点数小于 $n/2$，$w$ 侧的子树的顶点数大于 $n/2$，所以不可能再从 $w$ 移动到 $v$。因而该操作永远不会回到已经经过的顶点，而顶点数又是有限的，所以算法必然在有限步终止。</p></li><li><p>树中所有顶点到某个顶点的距离和中，到重心的距离和是最小的；如果有两个重心，那么到它们的距离和一样。</p></li><li><p>把两棵树通过一条边相连得到一棵新的树，那么新的树的重心在连接原来两棵树的重心的路径上。</p></li><li><p>在一棵树上添加或删除一个叶子，那么它的重心最多只移动一条边的距离。</p></li></ol><blockquote><p>更多证明请见：<a href=https://www.cnblogs.com/suxxsfe/p/13543253.html>树的重心的性质及其证明 - suxxsfe - 博客园 (cnblogs.com)</a></p></blockquote><h2 id=寻找树的重心><a href=#%e5%af%bb%e6%89%be%e6%a0%91%e7%9a%84%e9%87%8d%e5%bf%83 class=anchor><svg class="icon" aria-hidden="true" focusable="false" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5.0-3-1.69-3-3.5S2.55 3 4 3h4c1.45.0 3 1.69 3 3.5.0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98.0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98.0-2-1.22-2-2.5.0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45.0 3-1.69 3-3.5S14.5 6 13 6z"/></svg></a>寻找树的重心</h2><p>根据重心的定义，先以 $1$ 为根进行 DFS。在递归中计算子树大小 $siz[u]$，并求出最大的子树的大小 $maxs[u]$，比较出重心 $centroid$。</p><div class=highlight><div style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#00a8c8>void</span> <span style=color:#75af00>getCentroid</span><span style=color:#111>(</span><span style=color:#00a8c8>int</span> <span style=color:#111>u</span><span style=color:#111>,</span> <span style=color:#00a8c8>int</span> <span style=color:#111>fa</span><span style=color:#111>,</span> <span style=color:#00a8c8>int</span> <span style=color:#111>s</span><span style=color:#111>)</span> <span style=color:#111>{</span>
</span></span><span style=display:flex><span>  <span style=color:#111>siz</span><span style=color:#111>[</span><span style=color:#111>u</span><span style=color:#111>]</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span><span style=color:#111>;</span>
</span></span><span style=display:flex><span>  <span style=color:#111>maxs</span><span style=color:#111>[</span><span style=color:#111>u</span><span style=color:#111>]</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span><span style=color:#111>;</span>
</span></span><span style=display:flex><span>  <span style=color:#00a8c8>for</span> <span style=color:#111>(</span><span style=color:#00a8c8>int</span> <span style=color:#111>i</span> <span style=color:#f92672>=</span> <span style=color:#111>head</span><span style=color:#111>[</span><span style=color:#111>u</span><span style=color:#111>];</span> <span style=color:#111>i</span> <span style=color:#f92672>!=</span> <span style=color:#ae81ff>0</span><span style=color:#111>;</span> <span style=color:#111>i</span> <span style=color:#f92672>=</span> <span style=color:#111>nxt</span><span style=color:#111>[</span><span style=color:#111>i</span><span style=color:#111>])</span> <span style=color:#111>{</span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>if</span> <span style=color:#111>(</span><span style=color:#111>to</span><span style=color:#111>[</span><span style=color:#111>i</span><span style=color:#111>]</span> <span style=color:#f92672>==</span> <span style=color:#111>fa</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span>      <span style=color:#00a8c8>continue</span><span style=color:#111>;</span>
</span></span><span style=display:flex><span>    <span style=color:#111>getCentroid</span><span style=color:#111>(</span><span style=color:#111>to</span><span style=color:#111>[</span><span style=color:#111>i</span><span style=color:#111>],</span> <span style=color:#111>u</span><span style=color:#111>,</span> <span style=color:#111>s</span><span style=color:#111>);</span>
</span></span><span style=display:flex><span>    <span style=color:#111>siz</span><span style=color:#111>[</span><span style=color:#111>u</span><span style=color:#111>]</span> <span style=color:#f92672>+=</span> <span style=color:#111>siz</span><span style=color:#111>[</span><span style=color:#111>to</span><span style=color:#111>[</span><span style=color:#111>i</span><span style=color:#111>]];</span>
</span></span><span style=display:flex><span>    <span style=color:#111>maxs</span><span style=color:#111>[</span><span style=color:#111>u</span><span style=color:#111>]</span> <span style=color:#f92672>=</span> <span style=color:#111>max</span><span style=color:#111>(</span><span style=color:#111>maxs</span><span style=color:#111>[</span><span style=color:#111>u</span><span style=color:#111>],</span> <span style=color:#111>siz</span><span style=color:#111>[</span><span style=color:#111>to</span><span style=color:#111>[</span><span style=color:#111>i</span><span style=color:#111>]]);</span>
</span></span><span style=display:flex><span>  <span style=color:#111>}</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// “向上” 的部分也是该结点的子树
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#111>maxs</span><span style=color:#111>[</span><span style=color:#111>u</span><span style=color:#111>]</span> <span style=color:#f92672>=</span> <span style=color:#111>max</span><span style=color:#111>(</span><span style=color:#111>maxs</span><span style=color:#111>[</span><span style=color:#111>u</span><span style=color:#111>],</span> <span style=color:#111>s</span> <span style=color:#f92672>-</span> <span style=color:#111>siz</span><span style=color:#111>[</span><span style=color:#111>u</span><span style=color:#111>]);</span>
</span></span><span style=display:flex><span>  <span style=color:#00a8c8>if</span> <span style=color:#111>(</span><span style=color:#111>maxs</span><span style=color:#111>[</span><span style=color:#111>u</span><span style=color:#111>]</span> <span style=color:#f92672>&lt;</span> <span style=color:#111>maxs</span><span style=color:#111>[</span><span style=color:#111>centroid</span><span style=color:#111>]</span> <span style=color:#f92672>||</span> <span style=color:#f92672>!</span><span style=color:#111>centroid</span><span style=color:#111>)</span> <span style=color:#111>centroid</span> <span style=color:#f92672>=</span> <span style=color:#111>u</span><span style=color:#111>;</span>
</span></span><span style=display:flex><span><span style=color:#111>}</span>
</span></span><span style=display:flex><span><span style=color:#00a8c8>int</span> <span style=color:#75af00>main</span><span style=color:#111>()</span> <span style=color:#111>{</span>
</span></span><span style=display:flex><span>  <span style=color:#111>centroid</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span><span style=color:#111>;</span>
</span></span><span style=display:flex><span>  <span style=color:#111>getCentroid</span><span style=color:#111>(</span><span style=color:#ae81ff>1</span><span style=color:#111>,</span> <span style=color:#ae81ff>0</span><span style=color:#111>,</span> <span style=color:#111>n</span><span style=color:#111>);</span>
</span></span><span style=display:flex><span>  <span style=color:#00a8c8>return</span> <span style=color:#ae81ff>0</span><span style=color:#111>;</span>
</span></span><span style=display:flex><span><span style=color:#111>}</span>
</span></span></code></pre></td></tr></table></div></div><p>提交：<a href=https://cses.fi/problemset/task/2079>CSES - Finding a Centroid</a></p><h2 id=点分治><a href=#%e7%82%b9%e5%88%86%e6%b2%bb class=anchor><svg class="icon" aria-hidden="true" focusable="false" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5.0-3-1.69-3-3.5S2.55 3 4 3h4c1.45.0 3 1.69 3 3.5.0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98.0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98.0-2-1.22-2-2.5.0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45.0 3-1.69 3-3.5S14.5 6 13 6z"/></svg></a>点分治</h2><p>我们可以用点分治解决关于统计树上路径的问题。</p><h3 id=例一><a href=#%e4%be%8b%e4%b8%80 class=anchor><svg class="icon" aria-hidden="true" focusable="false" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5.0-3-1.69-3-3.5S2.55 3 4 3h4c1.45.0 3 1.69 3 3.5.0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98.0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98.0-2-1.22-2-2.5.0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45.0 3-1.69 3-3.5S14.5 6 13 6z"/></svg></a>例一</h3><blockquote><p><a href=https://www.luogu.com.cn/problem/P3806>Luogu P3806【模板】点分治 1</a>：给定一棵有 $n$ 个点的带边权树，$m$ 次询问，每次询问给出 $k$，询问树上距离为 $k$ 的点对是否存在。</p><p>$n\le 10000,m\le 100,k\le 10000000$</p></blockquote><p>暴力的做法至少需要 $O(n^{2})$，显然会超时，所以考虑分治。</p><p>如何分割呢？如果随意选择顶点的话，递归的深度可能退化成 $O(n)$。若我们每次选择子树的<strong>重心</strong>作为新的根结点，可以让递归的层数最少。因为每次树的大小至少减半，所以递归的深度是 $O(log n)$。</p><p>设当前的根结点是 $rt$。</p><p>对于每一条路径 $(u, v)$，必然满足以下三种情况之一：</p><ol><li>顶点 $u, v$ 在 $rt$ 的同一子树内。</li><li>顶点 $u, v$ 分别在 $rt$ 的不同子树内。</li><li>顶点 $u, v$ 其中一个是 $rt$。</li></ol><p>对于第 (1) 种情况，可以递归后转化成另外的情况。对于第 (2) 种情况，从顶点 $u$ 到顶点 $v$ 的路径必然经过根结点 $rt$，只要求出每个顶点到 $rt$ 的距离，就可以统计出答案。对于第 (3) 种情况，可以添加一个到 $rt$ 距离为 $0$ 的顶点，就转化为了第 (2) 种情况。</p><p>需要注意的是，在第 (1) 种情况中统计的同一子树的顶点对，要避免在第 (2) 种情况中被重复统计。通过<strong>容斥</strong>和类似于<strong>树上背包</strong>的方法可以去重。</p><p>最后的时间复杂度是 $O(nlog^{2}n)$。</p><p><a href=https://www.luogu.com.cn/record/82315924>RECORD</a>。</p><div class=highlight><div style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">23
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">24
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">25
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">26
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">27
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">28
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">29
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">30
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">31
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">32
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">33
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">34
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">35
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">36
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">37
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">38
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">39
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">40
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">41
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">42
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">43
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">44
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">45
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">46
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">47
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">48
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">49
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">50
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">51
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">52
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">53
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">54
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">55
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">56
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">57
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">58
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">59
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">60
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">61
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">62
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">63
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">64
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">65
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">66
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">67
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">68
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">69
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">70
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">71
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">72
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">73
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">74
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#00a8c8>int</span> <span style=color:#111>n</span><span style=color:#111>,</span> <span style=color:#111>m</span><span style=color:#111>;</span>
</span></span><span style=display:flex><span><span style=color:#00a8c8>int</span> <span style=color:#111>L</span><span style=color:#111>,</span> <span style=color:#111>p</span><span style=color:#111>;</span>
</span></span><span style=display:flex><span><span style=color:#00a8c8>int</span> <span style=color:#111>centroid</span><span style=color:#111>;</span>
</span></span><span style=display:flex><span><span style=color:#00a8c8>bool</span> <span style=color:#111>vis</span><span style=color:#111>[</span><span style=color:#111>MAXN</span><span style=color:#111>],</span> <span style=color:#111>cnt</span><span style=color:#111>[</span><span style=color:#111>MAXW</span><span style=color:#111>],</span> <span style=color:#111>ans</span><span style=color:#111>[</span><span style=color:#111>MAXM</span><span style=color:#111>];</span>
</span></span><span style=display:flex><span><span style=color:#00a8c8>int</span> <span style=color:#111>ask</span><span style=color:#111>[</span><span style=color:#111>MAXM</span><span style=color:#111>];</span>
</span></span><span style=display:flex><span><span style=color:#111>vector</span><span style=color:#f92672>&lt;</span> <span style=color:#111>std</span><span style=color:#f92672>::</span><span style=color:#111>pair</span><span style=color:#f92672>&lt;</span> <span style=color:#00a8c8>int</span><span style=color:#111>,</span> <span style=color:#00a8c8>int</span> <span style=color:#f92672>&gt;</span> <span style=color:#f92672>&gt;</span> <span style=color:#111>g</span><span style=color:#111>[</span><span style=color:#111>MAXN</span><span style=color:#111>];</span>
</span></span><span style=display:flex><span><span style=color:#00a8c8>int</span> <span style=color:#111>dis</span><span style=color:#111>[</span><span style=color:#111>MAXN</span><span style=color:#111>];</span>
</span></span><span style=display:flex><span><span style=color:#00a8c8>int</span> <span style=color:#111>siz</span><span style=color:#111>[</span><span style=color:#111>MAXN</span><span style=color:#111>],</span> <span style=color:#111>maxs</span><span style=color:#111>[</span><span style=color:#111>MAXN</span><span style=color:#111>];</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00a8c8>void</span> <span style=color:#75af00>getCentroid</span><span style=color:#111>(</span><span style=color:#00a8c8>int</span> <span style=color:#111>u</span><span style=color:#111>,</span> <span style=color:#00a8c8>int</span> <span style=color:#111>fa</span><span style=color:#111>,</span> <span style=color:#00a8c8>int</span> <span style=color:#111>s</span><span style=color:#111>)</span> <span style=color:#111>{</span>
</span></span><span style=display:flex><span>  <span style=color:#111>siz</span><span style=color:#111>[</span><span style=color:#111>u</span><span style=color:#111>]</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span><span style=color:#111>;</span>
</span></span><span style=display:flex><span>  <span style=color:#111>maxs</span><span style=color:#111>[</span><span style=color:#111>u</span><span style=color:#111>]</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span><span style=color:#111>;</span>
</span></span><span style=display:flex><span>  <span style=color:#00a8c8>for</span> <span style=color:#111>(</span><span style=color:#00a8c8>auto</span> <span style=color:#111>i</span> <span style=color:#111>:</span> <span style=color:#111>g</span><span style=color:#111>[</span><span style=color:#111>u</span><span style=color:#111>])</span> <span style=color:#111>{</span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>if</span> <span style=color:#111>(</span><span style=color:#111>i</span><span style=color:#111>.</span><span style=color:#111>first</span> <span style=color:#f92672>==</span> <span style=color:#111>fa</span> <span style=color:#f92672>||</span> <span style=color:#111>vis</span><span style=color:#111>[</span><span style=color:#111>i</span><span style=color:#111>.</span><span style=color:#111>first</span><span style=color:#111>])</span> <span style=color:#00a8c8>continue</span><span style=color:#111>;</span>
</span></span><span style=display:flex><span>    <span style=color:#111>getCentroid</span><span style=color:#111>(</span><span style=color:#111>i</span><span style=color:#111>.</span><span style=color:#111>first</span><span style=color:#111>,</span> <span style=color:#111>u</span><span style=color:#111>,</span> <span style=color:#111>s</span><span style=color:#111>);</span>
</span></span><span style=display:flex><span>    <span style=color:#111>siz</span><span style=color:#111>[</span><span style=color:#111>u</span><span style=color:#111>]</span> <span style=color:#f92672>+=</span> <span style=color:#111>siz</span><span style=color:#111>[</span><span style=color:#111>i</span><span style=color:#111>.</span><span style=color:#111>first</span><span style=color:#111>];</span>
</span></span><span style=display:flex><span>    <span style=color:#111>maxs</span><span style=color:#111>[</span><span style=color:#111>u</span><span style=color:#111>]</span> <span style=color:#f92672>=</span> <span style=color:#111>std</span><span style=color:#f92672>::</span><span style=color:#111>max</span><span style=color:#111>(</span><span style=color:#111>maxs</span><span style=color:#111>[</span><span style=color:#111>u</span><span style=color:#111>],</span> <span style=color:#111>siz</span><span style=color:#111>[</span><span style=color:#111>i</span><span style=color:#111>.</span><span style=color:#111>first</span><span style=color:#111>]);</span>
</span></span><span style=display:flex><span>  <span style=color:#111>}</span>
</span></span><span style=display:flex><span>  <span style=color:#111>maxs</span><span style=color:#111>[</span><span style=color:#111>u</span><span style=color:#111>]</span> <span style=color:#f92672>=</span> <span style=color:#111>std</span><span style=color:#f92672>::</span><span style=color:#111>max</span><span style=color:#111>(</span><span style=color:#111>maxs</span><span style=color:#111>[</span><span style=color:#111>u</span><span style=color:#111>],</span> <span style=color:#111>s</span> <span style=color:#f92672>-</span> <span style=color:#111>siz</span><span style=color:#111>[</span><span style=color:#111>u</span><span style=color:#111>]);</span>
</span></span><span style=display:flex><span>  <span style=color:#00a8c8>if</span> <span style=color:#111>(</span><span style=color:#111>maxs</span><span style=color:#111>[</span><span style=color:#111>u</span><span style=color:#111>]</span> <span style=color:#f92672>&lt;</span> <span style=color:#111>maxs</span><span style=color:#111>[</span><span style=color:#111>centroid</span><span style=color:#111>]</span> <span style=color:#f92672>||</span> <span style=color:#f92672>!</span><span style=color:#111>centroid</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span>    <span style=color:#111>centroid</span> <span style=color:#f92672>=</span> <span style=color:#111>u</span><span style=color:#111>;</span>
</span></span><span style=display:flex><span><span style=color:#111>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 获取子树中所有点到重心的距离
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#00a8c8>void</span> <span style=color:#75af00>getDis</span><span style=color:#111>(</span><span style=color:#00a8c8>int</span> <span style=color:#111>u</span><span style=color:#111>,</span> <span style=color:#00a8c8>int</span> <span style=color:#111>fa</span><span style=color:#111>,</span> <span style=color:#00a8c8>int</span> <span style=color:#111>d</span><span style=color:#111>)</span> <span style=color:#111>{</span>
</span></span><span style=display:flex><span>  <span style=color:#111>dis</span><span style=color:#111>[</span><span style=color:#111>p</span><span style=color:#f92672>++</span><span style=color:#111>]</span> <span style=color:#f92672>=</span> <span style=color:#111>d</span><span style=color:#111>;</span>
</span></span><span style=display:flex><span>  <span style=color:#00a8c8>for</span> <span style=color:#111>(</span><span style=color:#00a8c8>auto</span> <span style=color:#111>i</span> <span style=color:#111>:</span> <span style=color:#111>g</span><span style=color:#111>[</span><span style=color:#111>u</span><span style=color:#111>])</span> <span style=color:#111>{</span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>if</span> <span style=color:#111>(</span><span style=color:#111>i</span><span style=color:#111>.</span><span style=color:#111>first</span> <span style=color:#f92672>==</span> <span style=color:#111>fa</span> <span style=color:#f92672>||</span> <span style=color:#111>vis</span><span style=color:#111>[</span><span style=color:#111>i</span><span style=color:#111>.</span><span style=color:#111>first</span><span style=color:#111>])</span> <span style=color:#00a8c8>continue</span><span style=color:#111>;</span>
</span></span><span style=display:flex><span>    <span style=color:#111>getDis</span><span style=color:#111>(</span><span style=color:#111>i</span><span style=color:#111>.</span><span style=color:#111>first</span><span style=color:#111>,</span> <span style=color:#111>u</span><span style=color:#111>,</span> <span style=color:#111>d</span> <span style=color:#f92672>+</span> <span style=color:#111>i</span><span style=color:#111>.</span><span style=color:#111>second</span><span style=color:#111>);</span>
</span></span><span style=display:flex><span>  <span style=color:#111>}</span>
</span></span><span style=display:flex><span><span style=color:#111>}</span>
</span></span><span style=display:flex><span><span style=color:#00a8c8>void</span> <span style=color:#75af00>calc</span><span style=color:#111>()</span> <span style=color:#111>{</span>
</span></span><span style=display:flex><span>  <span style=color:#111>L</span> <span style=color:#f92672>=</span> <span style=color:#111>p</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span><span style=color:#111>;</span>
</span></span><span style=display:flex><span>  <span style=color:#111>cnt</span><span style=color:#111>[</span><span style=color:#ae81ff>0</span><span style=color:#111>]</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span><span style=color:#111>;</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 类似于树上背包
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#00a8c8>for</span> <span style=color:#111>(</span><span style=color:#00a8c8>auto</span> <span style=color:#111>i</span> <span style=color:#111>:</span> <span style=color:#111>g</span><span style=color:#111>[</span><span style=color:#111>centroid</span><span style=color:#111>])</span> <span style=color:#111>{</span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>if</span> <span style=color:#111>(</span><span style=color:#111>vis</span><span style=color:#111>[</span><span style=color:#111>i</span><span style=color:#111>.</span><span style=color:#111>first</span><span style=color:#111>])</span> <span style=color:#00a8c8>continue</span><span style=color:#111>;</span>
</span></span><span style=display:flex><span>    <span style=color:#111>getDis</span><span style=color:#111>(</span><span style=color:#111>i</span><span style=color:#111>.</span><span style=color:#111>first</span><span style=color:#111>,</span> <span style=color:#111>centroid</span><span style=color:#111>,</span> <span style=color:#111>i</span><span style=color:#111>.</span><span style=color:#111>second</span><span style=color:#111>);</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 一棵一棵子树合并，不会重复统计
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#00a8c8>for</span> <span style=color:#111>(</span><span style=color:#00a8c8>int</span> <span style=color:#111>i</span> <span style=color:#f92672>=</span> <span style=color:#111>L</span><span style=color:#111>;</span> <span style=color:#111>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#111>p</span><span style=color:#111>;</span> <span style=color:#111>i</span><span style=color:#f92672>++</span><span style=color:#111>)</span> <span style=color:#111>{</span>
</span></span><span style=display:flex><span>      <span style=color:#00a8c8>for</span> <span style=color:#111>(</span><span style=color:#00a8c8>int</span> <span style=color:#111>j</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span><span style=color:#111>;</span> <span style=color:#111>j</span> <span style=color:#f92672>&lt;</span> <span style=color:#111>m</span><span style=color:#111>;</span> <span style=color:#111>j</span><span style=color:#f92672>++</span><span style=color:#111>)</span> <span style=color:#111>{</span>
</span></span><span style=display:flex><span>        <span style=color:#00a8c8>if</span> <span style=color:#111>(</span><span style=color:#111>dis</span><span style=color:#111>[</span><span style=color:#111>i</span><span style=color:#111>]</span> <span style=color:#f92672>&gt;</span> <span style=color:#111>ask</span><span style=color:#111>[</span><span style=color:#111>j</span><span style=color:#111>])</span> <span style=color:#00a8c8>continue</span><span style=color:#111>;</span>
</span></span><span style=display:flex><span>        <span style=color:#111>ans</span><span style=color:#111>[</span><span style=color:#111>j</span><span style=color:#111>]</span> <span style=color:#f92672>|=</span> <span style=color:#111>cnt</span><span style=color:#111>[</span><span style=color:#111>ask</span><span style=color:#111>[</span><span style=color:#111>j</span><span style=color:#111>]</span> <span style=color:#f92672>-</span> <span style=color:#111>dis</span><span style=color:#111>[</span><span style=color:#111>i</span><span style=color:#111>]];</span>
</span></span><span style=display:flex><span>      <span style=color:#111>}</span>
</span></span><span style=display:flex><span>    <span style=color:#111>}</span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>for</span> <span style=color:#111>(</span><span style=color:#00a8c8>int</span> <span style=color:#111>j</span> <span style=color:#f92672>=</span> <span style=color:#111>L</span><span style=color:#111>;</span> <span style=color:#111>j</span> <span style=color:#f92672>&lt;</span> <span style=color:#111>p</span><span style=color:#111>;</span> <span style=color:#111>j</span><span style=color:#f92672>++</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span>      <span style=color:#111>cnt</span><span style=color:#111>[</span><span style=color:#111>dis</span><span style=color:#111>[</span><span style=color:#111>j</span><span style=color:#111>]]</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span><span style=color:#111>;</span>
</span></span><span style=display:flex><span>    <span style=color:#111>L</span> <span style=color:#f92672>=</span> <span style=color:#111>p</span><span style=color:#111>;</span>
</span></span><span style=display:flex><span>  <span style=color:#111>}</span>
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 还原 cnt 数组
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#00a8c8>for</span> <span style=color:#111>(</span><span style=color:#00a8c8>int</span> <span style=color:#111>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span><span style=color:#111>;</span> <span style=color:#111>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#111>p</span><span style=color:#111>;</span> <span style=color:#111>i</span><span style=color:#f92672>++</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span>    <span style=color:#111>cnt</span><span style=color:#111>[</span><span style=color:#111>dis</span><span style=color:#111>[</span><span style=color:#111>i</span><span style=color:#111>]]</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span><span style=color:#111>;</span>  <span style=color:#75715e>// 不能用 memset
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#111>}</span>
</span></span><span style=display:flex><span><span style=color:#00a8c8>void</span> <span style=color:#75af00>solve</span><span style=color:#111>(</span><span style=color:#00a8c8>int</span> <span style=color:#111>u</span><span style=color:#111>,</span> <span style=color:#00a8c8>int</span> <span style=color:#111>size</span><span style=color:#111>)</span> <span style=color:#111>{</span>
</span></span><span style=display:flex><span>  <span style=color:#111>centroid</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span><span style=color:#111>;</span>
</span></span><span style=display:flex><span>  <span style=color:#111>getCentroid</span><span style=color:#111>(</span><span style=color:#111>u</span><span style=color:#111>,</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span><span style=color:#111>,</span> <span style=color:#111>size</span><span style=color:#111>);</span>
</span></span><span style=display:flex><span>  <span style=color:#111>getCentroid</span><span style=color:#111>(</span><span style=color:#111>centroid</span><span style=color:#111>,</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span><span style=color:#111>,</span> <span style=color:#111>size</span><span style=color:#111>);</span>  <span style=color:#75715e>// 再求一次 siz，防止后面找重心时出错
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#111>vis</span><span style=color:#111>[</span><span style=color:#111>centroid</span><span style=color:#111>]</span> <span style=color:#f92672>=</span> <span style=color:#111>true</span><span style=color:#111>;</span>
</span></span><span style=display:flex><span>  <span style=color:#111>calc</span><span style=color:#111>();</span>
</span></span><span style=display:flex><span>  <span style=color:#00a8c8>for</span> <span style=color:#111>(</span><span style=color:#00a8c8>auto</span> <span style=color:#111>i</span> <span style=color:#111>:</span> <span style=color:#111>g</span><span style=color:#111>[</span><span style=color:#111>centroid</span><span style=color:#111>])</span> <span style=color:#111>{</span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>if</span> <span style=color:#111>(</span><span style=color:#111>vis</span><span style=color:#111>[</span><span style=color:#111>i</span><span style=color:#111>.</span><span style=color:#111>first</span><span style=color:#111>])</span> <span style=color:#00a8c8>continue</span><span style=color:#111>;</span>
</span></span><span style=display:flex><span>    <span style=color:#111>solve</span><span style=color:#111>(</span><span style=color:#111>i</span><span style=color:#111>.</span><span style=color:#111>first</span><span style=color:#111>,</span> <span style=color:#111>siz</span><span style=color:#111>[</span><span style=color:#111>i</span><span style=color:#111>.</span><span style=color:#111>first</span><span style=color:#111>]);</span>
</span></span><span style=display:flex><span>  <span style=color:#111>}</span>
</span></span><span style=display:flex><span><span style=color:#111>}</span>
</span></span><span style=display:flex><span><span style=color:#00a8c8>int</span> <span style=color:#75af00>main</span><span style=color:#111>()</span> <span style=color:#111>{</span>
</span></span><span style=display:flex><span>  <span style=color:#111>solve</span><span style=color:#111>(</span><span style=color:#ae81ff>1</span><span style=color:#111>,</span> <span style=color:#111>n</span><span style=color:#111>);</span>
</span></span><span style=display:flex><span>  <span style=color:#00a8c8>for</span> <span style=color:#111>(</span><span style=color:#00a8c8>int</span> <span style=color:#111>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span><span style=color:#111>;</span> <span style=color:#111>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#111>m</span><span style=color:#111>;</span> <span style=color:#111>i</span><span style=color:#f92672>++</span><span style=color:#111>)</span> <span style=color:#111>{</span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>if</span> <span style=color:#111>(</span><span style=color:#111>ans</span><span style=color:#111>[</span><span style=color:#111>i</span><span style=color:#111>])</span> <span style=color:#111>cout</span> <span style=color:#f92672>&lt;&lt;</span> <span style=color:#d88200>&#34;AYE</span><span style=color:#8045ff>\n</span><span style=color:#d88200>&#34;</span><span style=color:#111>;</span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>else</span> <span style=color:#111>cout</span> <span style=color:#f92672>&lt;&lt;</span> <span style=color:#d88200>&#34;NAY</span><span style=color:#8045ff>\n</span><span style=color:#d88200>&#34;</span><span style=color:#111>;</span>
</span></span><span style=display:flex><span>  <span style=color:#111>}</span>
</span></span><span style=display:flex><span>  <span style=color:#00a8c8>return</span> <span style=color:#ae81ff>0</span><span style=color:#111>;</span>
</span></span><span style=display:flex><span><span style=color:#111>}</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>需要注意的细节</strong>：</p><ul><li><p>分治的时候求出新的重心之后，也要<strong>再次</strong>求子树 $siz$。</p><p>详见：<a href=https://liu-cheng-ao.blog.uoj.ac/blog/2969>一种基于错误的寻找重心方法的点分治的复杂度分析 - 博客 - liu_cheng_ao的博客 (uoj.ac)</a></p><p>账号 <code>920848348</code> 评论：</p><p><img src=https://raw.githubusercontent.com/ChungZH/img/main/centroid-decomposition/graph.png alt=graph></p><blockquote><p>对于大部分点分治的代码中，不能直接 <code>size = siz[v]</code>，否则会导致后面的重心求错（可以用下面的样例试一下，然后输出重心节点看一下，你会发现从 $6$->$3$ 这一大块的重心应该是 $2$，而代码输出是 $1$。原因在于：</p><p>由于一开始从 点 $1$ 开始找整棵树的重心，此时的 $siz[u]$ 表示的仅仅是以 1 为根结点的树中，$u$ 的子树大小。那么现在重心 $root$ 找到了，那么从这整棵树的重心 $root$ 开始深搜时，若有边 $root$->$v$ ，而此时的 $siz[v]$ 的值并不是以 $v$ 为根的子树的大小（这个子树当然不包括父亲 $root$ 那一块）。具体为什么，这里给一组样例，大家可以在图中画一下。
此样例的对应题目为 <a href=https://www.luogu.com.cn/problem/P3806>Luogu P3806【模板】点分治 1</a>。</p><p>然后我们一步一步来：</p><p>先从 $1$ 开始 dfs ，统计 $siz$ 数组，此时很清晰的知道 $siz[3] = 7$ ，因为是以 $1$ 为根深搜的。很明显，一开始这整棵树的重心是 6 号节点，那么接下来，我们可以发现：</p><p>当从点 $6$ 开始 dfs 时，有 $6$->$3$ 这条边，那么按理来说，$size = siz[3]$，此时 $size$ 表示的是以 $3$ 为根的子树的大小，可看图上明明是 $5$ 啊（在点 $3$ 的左边，不包含点 $6$ 那边）。可是此时的 $siz[3]$ 为 $7$，而并非是 $5$ 。这是由于选定的深搜节点不同，统计的不同而导致的。$siz[3]$ 的正确值理应来自于从 点 $6$ 开始深搜的值。
故我们可以得出结论，用 <code>getroot(1,0)</code> 找到整棵树的重心之后，再来一次 <code>getroot(root, 0)</code>，来确定以重心为根结点时的 $siz$ 数组。这下就可以直接 <code>size = siz[v]</code> 了。</p></blockquote><pre tabindex=0><code>11 1
6 7 1
6 8 1
7 9 1
7 10 1
8 11 1
1 2 1
1 3 1
2 4 1
2 5 1
3 6 1
2
</code></pre></li><li><p>不要用 <code>memset</code> 粗暴还原，会浪费很多时间。</p></li></ul><h3 id=例二><a href=#%e4%be%8b%e4%ba%8c class=anchor><svg class="icon" aria-hidden="true" focusable="false" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5.0-3-1.69-3-3.5S2.55 3 4 3h4c1.45.0 3 1.69 3 3.5.0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98.0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98.0-2-1.22-2-2.5.0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45.0 3-1.69 3-3.5S14.5 6 13 6z"/></svg></a>例二</h3><blockquote><p><a href=https://www.luogu.com.cn/problem/P4178>Luogu P4178 Tree</a>：给定一棵有 $n$ 个点的带权树，给出 $k$，询问树上距离小于等于 $k$ 的点对数量。</p><p>$n\le 40000,k\le 20000,w_i\le 1000$</p></blockquote><p>这题方法比较多。下面的代码用 <strong>容斥</strong> 进行去重和 <strong>双指针</strong> （除此之外还可以用<strong>二分</strong>）统计答案。</p><div class=highlight><div style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">23
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">24
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">25
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">26
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">27
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">28
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">29
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#00a8c8>int</span> <span style=color:#75af00>calc</span><span style=color:#111>(</span><span style=color:#00a8c8>int</span> <span style=color:#111>u</span><span style=color:#111>,</span> <span style=color:#00a8c8>int</span> <span style=color:#111>w</span><span style=color:#111>)</span> <span style=color:#111>{</span>
</span></span><span style=display:flex><span>  <span style=color:#111>dis</span><span style=color:#111>.</span><span style=color:#111>clear</span><span style=color:#111>();</span>
</span></span><span style=display:flex><span>  <span style=color:#111>getDis</span><span style=color:#111>(</span><span style=color:#111>u</span><span style=color:#111>,</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span><span style=color:#111>,</span> <span style=color:#111>w</span><span style=color:#111>);</span>
</span></span><span style=display:flex><span>  <span style=color:#111>sort</span><span style=color:#111>(</span><span style=color:#111>dis</span><span style=color:#111>.</span><span style=color:#111>begin</span><span style=color:#111>(),</span> <span style=color:#111>dis</span><span style=color:#111>.</span><span style=color:#111>end</span><span style=color:#111>());</span>
</span></span><span style=display:flex><span>  <span style=color:#00a8c8>int</span> <span style=color:#111>sum</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span><span style=color:#111>;</span>
</span></span><span style=display:flex><span>  <span style=color:#00a8c8>int</span> <span style=color:#111>L</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span><span style=color:#111>,</span> <span style=color:#111>R</span> <span style=color:#f92672>=</span> <span style=color:#111>dis</span><span style=color:#111>.</span><span style=color:#111>size</span><span style=color:#111>()</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span><span style=color:#111>;</span>  <span style=color:#75715e>// 双指针
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#00a8c8>while</span> <span style=color:#111>(</span><span style=color:#111>L</span> <span style=color:#f92672>&lt;</span> <span style=color:#111>R</span><span style=color:#111>)</span> <span style=color:#111>{</span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>if</span> <span style=color:#111>(</span><span style=color:#111>dis</span><span style=color:#111>[</span><span style=color:#111>L</span><span style=color:#111>]</span> <span style=color:#f92672>+</span> <span style=color:#111>dis</span><span style=color:#111>[</span><span style=color:#111>R</span><span style=color:#111>]</span> <span style=color:#f92672>&lt;=</span> <span style=color:#111>k</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span>      <span style=color:#111>sum</span> <span style=color:#f92672>+=</span> <span style=color:#111>R</span> <span style=color:#f92672>-</span> <span style=color:#111>L</span><span style=color:#111>,</span> <span style=color:#111>L</span><span style=color:#f92672>++</span><span style=color:#111>;</span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>else</span>
</span></span><span style=display:flex><span>      <span style=color:#111>R</span><span style=color:#f92672>--</span><span style=color:#111>;</span>
</span></span><span style=display:flex><span>  <span style=color:#111>}</span>
</span></span><span style=display:flex><span>  <span style=color:#00a8c8>return</span> <span style=color:#111>sum</span><span style=color:#111>;</span>
</span></span><span style=display:flex><span><span style=color:#111>}</span>
</span></span><span style=display:flex><span><span style=color:#00a8c8>void</span> <span style=color:#75af00>solve</span><span style=color:#111>(</span><span style=color:#00a8c8>int</span> <span style=color:#111>u</span><span style=color:#111>,</span> <span style=color:#00a8c8>int</span> <span style=color:#111>size</span><span style=color:#111>)</span> <span style=color:#111>{</span>
</span></span><span style=display:flex><span>  <span style=color:#111>centroid</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span><span style=color:#111>;</span>
</span></span><span style=display:flex><span>  <span style=color:#111>getCentroid</span><span style=color:#111>(</span><span style=color:#111>u</span><span style=color:#111>,</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span><span style=color:#111>,</span> <span style=color:#111>size</span><span style=color:#111>);</span>
</span></span><span style=display:flex><span>  <span style=color:#111>getCentroid</span><span style=color:#111>(</span><span style=color:#111>centroid</span><span style=color:#111>,</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span><span style=color:#111>,</span> <span style=color:#111>size</span><span style=color:#111>);</span>
</span></span><span style=display:flex><span>  <span style=color:#111>vis</span><span style=color:#111>[</span><span style=color:#111>centroid</span><span style=color:#111>]</span> <span style=color:#f92672>=</span> <span style=color:#111>true</span><span style=color:#111>;</span>
</span></span><span style=display:flex><span>  <span style=color:#111>ans</span> <span style=color:#f92672>+=</span> <span style=color:#111>calc</span><span style=color:#111>(</span><span style=color:#111>centroid</span><span style=color:#111>,</span> <span style=color:#ae81ff>0</span><span style=color:#111>);</span>
</span></span><span style=display:flex><span>  <span style=color:#00a8c8>for</span> <span style=color:#111>(</span><span style=color:#00a8c8>auto</span> <span style=color:#111>i</span> <span style=color:#111>:</span> <span style=color:#111>g</span><span style=color:#111>[</span><span style=color:#111>centroid</span><span style=color:#111>])</span> <span style=color:#111>{</span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>if</span> <span style=color:#111>(</span><span style=color:#111>vis</span><span style=color:#111>[</span><span style=color:#111>i</span><span style=color:#111>.</span><span style=color:#111>first</span><span style=color:#111>])</span> <span style=color:#00a8c8>continue</span><span style=color:#111>;</span>
</span></span><span style=display:flex><span>    <span style=color:#111>ans</span> <span style=color:#f92672>-=</span> <span style=color:#111>calc</span><span style=color:#111>(</span><span style=color:#111>i</span><span style=color:#111>.</span><span style=color:#111>first</span><span style=color:#111>,</span> <span style=color:#111>i</span><span style=color:#111>.</span><span style=color:#111>second</span><span style=color:#111>);</span> <span style=color:#75715e>// 容斥。去除错误的答案。
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#111>}</span>
</span></span><span style=display:flex><span>  <span style=color:#00a8c8>for</span> <span style=color:#111>(</span><span style=color:#00a8c8>auto</span> <span style=color:#111>i</span> <span style=color:#111>:</span> <span style=color:#111>g</span><span style=color:#111>[</span><span style=color:#111>centroid</span><span style=color:#111>])</span> <span style=color:#111>{</span>
</span></span><span style=display:flex><span>    <span style=color:#00a8c8>if</span> <span style=color:#111>(</span><span style=color:#111>vis</span><span style=color:#111>[</span><span style=color:#111>i</span><span style=color:#111>.</span><span style=color:#111>first</span><span style=color:#111>])</span> <span style=color:#00a8c8>continue</span><span style=color:#111>;</span>
</span></span><span style=display:flex><span>    <span style=color:#111>solve</span><span style=color:#111>(</span><span style=color:#111>i</span><span style=color:#111>.</span><span style=color:#111>first</span><span style=color:#111>,</span> <span style=color:#111>siz</span><span style=color:#111>[</span><span style=color:#111>i</span><span style=color:#111>.</span><span style=color:#111>first</span><span style=color:#111>]);</span>
</span></span><span style=display:flex><span>  <span style=color:#111>}</span>
</span></span><span style=display:flex><span><span style=color:#111>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=例三><a href=#%e4%be%8b%e4%b8%89 class=anchor><svg class="icon" aria-hidden="true" focusable="false" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5.0-3-1.69-3-3.5S2.55 3 4 3h4c1.45.0 3 1.69 3 3.5.0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98.0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98.0-2-1.22-2-2.5.0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45.0 3-1.69 3-3.5S14.5 6 13 6z"/></svg></a>例三</h3><p>暂且咕咕咕。🕊</p><h2 id=习题><a href=#%e4%b9%a0%e9%a2%98 class=anchor><svg class="icon" aria-hidden="true" focusable="false" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5.0-3-1.69-3-3.5S2.55 3 4 3h4c1.45.0 3 1.69 3 3.5.0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98.0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98.0-2-1.22-2-2.5.0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45.0 3-1.69 3-3.5S14.5 6 13 6z"/></svg></a>习题</h2><ul><li><input disabled type=checkbox> <a href=https://www.luogu.com.cn/problem/P4149>Luogu P4149 [IOI2011]Race</a></li><li><input disabled type=checkbox> <a href=https://www.luogu.com.cn/problem/P3714>Luogu P3714 [BJOI2017]树的难题</a></li><li><input disabled type=checkbox> <a href=https://www.luogu.com.cn/problem/P2634>Luogu P2634 [国家集训队]聪聪可可</a></li></ul><h2 id=参考资料><a href=#%e5%8f%82%e8%80%83%e8%b5%84%e6%96%99 class=anchor><svg class="icon" aria-hidden="true" focusable="false" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5.0-3-1.69-3-3.5S2.55 3 4 3h4c1.45.0 3 1.69 3 3.5.0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98.0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98.0-2-1.22-2-2.5.0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45.0 3-1.69 3-3.5S14.5 6 13 6z"/></svg></a>参考资料</h2><ul><li>《挑战程序设计竞赛》</li><li><a href=https://oi-wiki.org/>OI Wiki</a></li></ul><p>🙇‍</p></div><div class=paginav><a rel=prev href=/articles/hugo-klay/ title="Previous post (older)"><span>Prev</span><div class=paginav-title>第一次做主题：hugo-klay</div></a><a class=text-right rel=next href=/articles/slope-opt-dp/ title="Next post (newer)"><span>Next</span><div class=paginav-title>斜率优化 DP 笔记</div></a></div></div><div class=container><script src=https://giscus.app/client.js data-repo=ChungZH/ChungZH.github.io data-repo-id="MDEwOlJlcG9zaXRvcnkxNzcxMjMzNjI=" data-category=Comments data-category-id=DIC_kwDOCo6wIs4B_i5g data-mapping=title data-reactions-enabled=1 data-emit-metadata=0 data-theme=light crossorigin=anonymous async></script><script>function setGiscusTheme(e){let t=document.querySelector(".giscus iframe");t&&t.contentWindow.postMessage({giscus:{setConfig:{theme:e}}},"https://giscus.app")}const colorSchemeQueryList=window.matchMedia("(prefers-color-scheme: dark)"),setColorScheme=e=>{setGiscusTheme(e.matches?"dark_dimmed":"light")};setColorScheme(colorSchemeQueryList),colorSchemeQueryList.addEventListener("change",setColorScheme)</script></div></main><footer class="text-sm leading-6 mt-10"><div class="pt-10 pb-28 border-t border-slate-200 sm:flex justify-between text-slate-500 dark:border-slate-200/5"><div class="mb-6 sm:mb-0 sm:flex"><p>Made with ❤</p><p class="sm:ml-4 sm:pl-4 sm:border-l sm:border-slate-200 dark:sm:border-slate-200/5">By
<a class="hover:text-slate-900 dark:hover:text-slate-400" href=https://github.com/ChungZH>ChungZH</a></p><p class="sm:ml-4 sm:pl-4 sm:border-l sm:border-slate-200 dark:sm:border-slate-200/5">Theme hugo-klay</p></div></div><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.css integrity=sha384-Um5gpz1odJg5Z4HAmzPtgZKdTBHZdw8S29IecapCSB31ligYPhHQZMIlWLYQGVoc crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.js integrity=sha384-YNHdsYkH6gMx9y3mRkmcJ2mFUjTd0qNQQvY9VYZgQd7DcN7env35GzlmFaZ23JGp crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/contrib/auto-render.min.js integrity=sha384-vZTG03m+2yp6N6BNi5iM4rW4oIwk5DfcNdFfxkk9ZWpDriOkXX8voJBFrAO7MpVl crossorigin=anonymous onload='renderMathInElement(document.querySelector(".article-post"),{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}]})'></script></footer></div></body></html>